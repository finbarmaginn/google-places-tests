<!DOCTYPE html>
<html>
<head>
  <title>Place Autocomplete</title>
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
  <meta charset="utf-8">

</head>

<style type="text/css">

  input[type="text"] {
    background-color: #fff;
    font-family: Roboto;
    font-size: 15px;
    font-weight: 300;
    margin-left: 12px;
    padding: 0 11px 0 13px;
    text-overflow: ellipsis;
    width: 300px;
  }

</style>

<body>

<h2>Using Autocomplete input</h2>
<input id="pac-input" class="controls" type="text"
       placeholder="Enter a location">


<h2>Using Autocomplete service</h2>

<p>Use Regions?</p>
<form action="">
  <input type="radio" name="useRegions" value="noRegions" checked="checked">No
  <input type="radio" name="useRegions" value="regions">Yes
 <!-- <input type="radio" name="useRegions" value="merged">Merge both-->
</form>

<input id="svc-input" class="controls" type="text"
       placeholder="Enter a location">


<div id="output"></div>

<script>
  var autocompleteService;

  function init() {

    autocompleteService = new google.maps.places.AutocompleteService();

    var input = /** @type {!HTMLInputElement} */(
      document.getElementById('pac-input'));

    var autocomplete = new google.maps.places.Autocomplete(input);

    autocomplete.addListener('place_changed', function () {
      //code when input changed
    });

    //_____________________________________________svc

    var input = /** @type {!HTMLInputElement} */(
      document.getElementById('svc-input'));

    input.addEventListener("keyup", function (e) {

      var output = "";

      var regionsOption = document.querySelector('input[name="useRegions"]:checked').value;

      switch (regionsOption) {

        case 'noRegions':
          getAutocompleteServiceResults(input.value, false);
          break;

        case 'regions':
          getAutocompleteServiceResults(input.value, true);
          break;

        case 'merged':
          var noRegions = getAutocompleteServiceResults(inputMerged.value, false);
          //bad code cause I want people to run without npm
          setTimeout(function () {
            var withRegions = getAutocompleteServiceResults(inputMerged.value, true);
          }, 500)
          break;

        default:
          break
      }

    });

    /**
     * Gets results array
     * @param searchTerm
     * @param useRegions
     */
    //todo wire out babel promise
    function getAutocompleteServiceResults(searchTerm, useRegions) {
      /*    var Promise = new Promise(function (resolve, reject) {

       })*/
      var types = useRegions ? '(regions)' : null;
      autocompleteService.getPlacePredictions({
          input: searchTerm,
          componentRestrictions: {country: 'uk'},
          types: types ? [types] : null,
        }, function (newData) {
          if (newData === null) {
            console.log('No results for suggestions');
          }

          var output = newData.map(function (item) {
            return item.description;
          }).join("<br>");


          //set the page for viewing the data from google
          document.getElementById("output").innerHTML = '<pre>' + output + '</pre>';

        }
      );
      //return Promise;
    }
  }


</script>
<script src="https://maps.googleapis.com/maps/api/js?signed_in=true&libraries=places&callback=init"
        async defer></script>
</body>
</html>
